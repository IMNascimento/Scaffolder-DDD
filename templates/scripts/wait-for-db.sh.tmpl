#!/usr/bin/env bash
set -e
until python - <<'PY'
import asyncio, os
import sqlalchemy as sa
from sqlalchemy.ext.asyncio import create_async_engine
url=os.getenv('DATABASE_URL','')
async def ping():
    e=create_async_engine(url)
    async with e.connect() as c:
        await c.execute(sa.text('SELECT 1'))
asyncio.run(ping())
PY

do echo "Aguardando DB..."; sleep 1; done